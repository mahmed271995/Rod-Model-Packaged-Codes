function Kmat=K_mat(Y,j)
global E G I1 I2 I3

ds = 0.01;
I=eye(3);

C10=0;
C11=E*I1;
C12=0;
C13=0;
C14=0;
C15=0;
C20=0;
C21=E*I2;
C22=0;
C23=600;
C24=0;
C25=0;
C30=0;
C31=G*I3;
C32=0;
C33=0;
C34=0;
C35=0;

% initial curvature:
k0=[0; 0; 0];

fs = 2*(ds*(j-1))^3-4*(ds*(j-1))^2+3*(ds*(j-1))+1;

B=[fs*(C11+2*C12*(Y(1)-k0(1,1))+3*C13*((Y(1)-k0(1,1))^2)+4*C14*((Y(1)-k0(1,1))^3)+5*C15*((Y(1)-k0(1,1))^4)) 0 0;
   0 fs*(C21+2*C22*(Y(2)-k0(2,1))+3*C23*((Y(2)-k0(2,1))^2)+4*C24*((Y(2)-k0(2,1))^3)+5*C25*((Y(2)-k0(2,1))^4)) 0;
   0 0 fs*(C31+2*C32*(Y(3)-k0(3,1))+3*C33*((Y(3)-k0(3,1))^2)+4*C34*((Y(3)-k0(3,1))^3)+5*C35*((Y(3)-k0(3,1))^4))];


Kmat=-1*blkdiag(I,I,B,I);

